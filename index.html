<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carta Mágica Interativa</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Cormorant+Garamond:wght@400;600&family=Roboto:wght@400&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #0b0b1b; --envelope-body-color: #c7aa8b; --envelope-flap-color: #b99d7e;
            --letter-paper-color: #f3e9d8; --font-main: 'Roboto', 'Segoe UI', sans-serif;
            --font-cursive: 'Dancing Script', cursive;
            --font-elegant: 'Cormorant Garamond', serif;
            --border-radius-envelope: 4px;
            --flap-height-ratio: 0.55; --envelope-width: 20rem;
            --envelope-height: calc(var(--envelope-width) * 0.675);
            /* --- AJUSTE NA ALTURA DA LINHA --- */
            --line-height-letter: 24px;
        }
        body {
    display: flex;
    justify-content: center;
    align-items: flex-start; /* alinha pelo topo em vez do centro */
    min-height: 100vh;
    margin: 0;
    background-color: var(--bg-color);
    font-family: var(--font-main);
    overflow: hidden;
    padding-top: 290px; /* <-- ajusta quanto para baixo você quer */
}
        
        /* --- CÓDIGO NOVO ADICIONADO --- */
        .floating-image-container {
            position: absolute;
            top: calc(32% - 180px); /* Ajusta a altura acima do envelope */
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            pointer-events: none; /* Para não interferir no clique do envelope */
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .floating-image {
            width: 200px;
            height: auto;
            /* Aplica as duas animações */
            animation: breathe 4s ease-in-out infinite alternate, glow 5s linear infinite;
        }

.envelope-container {
    position: relative;
    margin-top: 60px; /* empurra o envelope um pouco para baixo */
    width: var(--envelope-width, 80vw);
    height: var(--envelope-height, 54vw);
    max-width: 320px;
    max-height: 216px;
    cursor: pointer;
    border-radius: var(--border-radius-envelope);
    perspective: 1000px;
    transition: transform 0.5s ease, opacity 0.5s ease;
}
        .envelope-container:hover { transform: translateY(-10px); }
        .letter { 
            position: absolute; bottom: 0; left: 0; right: 0; margin: auto; width: 92%; height: 92%;
            background-color: var(--letter-paper-color);
            box-shadow: 1px 1px 8px rgba(0,0,0,0.2); border: 1px solid #dcd0b9;
            box-sizing: border-box; z-index: 0; display: flex; flex-direction: column;
            /* --- AJUSTES NO PADDING PARA ALINHAMENTO E RESPIRO --- */
            padding: 8px 25px 12px;
            will-change: transform; transition: transform 0.7s 0s ease-in-out, z-index 0s 0.7s; border-radius: 2px;
            background-image: linear-gradient(to top, rgba(0,0,0,0.05) 1px, transparent 1px), repeating-linear-gradient( to bottom, transparent 0, transparent calc(var(--line-height-letter) - 1px), rgba(180, 160, 130, 0.3) var(--line-height-letter) );
            background-size: 100% var(--line-height-letter);
            font-family: var(--font-elegant);
            color: #4a3b2e;
        }
        .letter h3 {
            font-family: var(--font-cursive);
            font-size: clamp(22px, 1.4em, 28px);
            /* --- AJUSTE NA MARGEM PARA SINCRONIZAR COM A LINHA --- */
            margin: 0 0 4px 0;
            line-height: 1.2;
            text-align: center;
            color: #5a4a3a;
        }
        .letter p {
            font-size: clamp(14px, 0.9em, 16px);
            margin: 0;
            line-height: var(--line-height-letter);
            font-weight: 400;
        }
        .envelope-back { position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; background-color: var(--envelope-body-color); z-index: 2; border-radius: var(--border-radius-envelope); box-shadow: 0 6px 15px rgba(0,0,0,0.3), inset 0 0 20px rgba(0,0,0,0.15), inset 0 0 0 1px rgba(0,0,0,0.05); overflow: hidden; }
        .envelope-back > div { position: absolute; bottom: 0; left: 0; width: 100%; height: 55%; background-color: #d3b99e; clip-path: polygon(50% 0, 100% 100%, 0 100%); border-top: 1px solid rgba(0,0,0,0.07); z-index: 1; box-shadow: inset 0 5px 10px rgba(0,0,0,0.1); }
        .flap { position: absolute; top: 0; left: 0; width: 100%; height: calc(var(--envelope-height) * var(--flap-height-ratio)); background: linear-gradient(to bottom, #e0c8a8 0%, var(--envelope-flap-color) 100%); clip-path: polygon(0 0, 100% 0, 50% 100%); transform-origin: top center; z-index: 3; will-change: transform; transition: transform 0.7s 0.7s ease-in-out; display: flex; justify-content: center; align-items: flex-start; border-top-left-radius: var(--border-radius-envelope); border-top-right-radius: var(--border-radius-envelope); border-bottom: 1px solid rgba(0,0,0,0.1); box-shadow: inset 0 8px 15px rgba(0,0,0,0.2), inset 0 0 5px rgba(0,0,0,0.1); }
        .flap::before { content: ''; position: absolute; bottom: -1px; left: 0; width: 100%; height: 2px; background: linear-gradient(to right, transparent 10%, rgba(0,0,0,0.3) 25%, rgba(0,0,0,0.3) 75%, transparent 90%); z-index: 4; }
        .top-stamp { position: absolute; top: 1rem; left: 50%; transform: translateX(-50%); width: 4rem; max-width: 60px; opacity: 0.7; z-index: 5; pointer-events: none; transition: opacity 0.3s 0.7s ease; }
        .seal { position: absolute; top: 52%; left: 50%; transform: translate(-50%, -50%); width: 3.5rem; height: 3.5rem; max-width: 65px; max-height: 65px; z-index: 4; transition: opacity 0.3s ease-in-out, transform 0.3s ease; filter: drop-shadow(0 3px 5px rgba(0,0,0,0.5)); }
        .envelope-container.open .flap { transition-delay: 0s; transform: rotateX(180deg); z-index: 1; }
        .envelope-container.open .letter { z-index: 5; transition-delay: 0.5s; transform: translateY(calc(-75% - 10px)); }
        .envelope-container.open .seal { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
        .envelope-container.open .top-stamp { opacity: 0; transition-delay: 0s; }
        @media (min-width: 450px) { .envelope-container.open .letter { transform: translateY(calc(-100px - 10px)); } }

        .secret-button { position: fixed; bottom: 25px; right: 25px; z-index: 202; width: 50px; height: 50px; background-color: rgba(0, 0, 0, 0.2); border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; opacity: 0.6; transition: all 0.5s ease; transform: scale(1); backdrop-filter: blur(3px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .secret-button:hover { opacity: 1; transform: scale(1.1); box-shadow: 0 0 15px rgba(255, 215, 0, 0.6); }
        .hallows-icon { position: relative; width: 25px; height: 25px; display: flex; justify-content: center; align-items: center; }
        .hallows-icon .triangle { width: 0; height: 0; border-left: 12.5px solid transparent; border-right: 12.5px solid transparent; border-bottom: 22px solid white; }
        .hallows-icon .circle { position: absolute; width: 12px; height: 12px; border: 2px solid white; border-radius: 50%; top: 5px; }
        .hallows-icon .line { position: absolute; width: 2px; height: 25px; background-color: white; }
        .secret-button .tooltip-text { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); background-color: #333; color: #fff; padding: 5px 10px; border-radius: 5px; font-size: 12px; white-space: nowrap; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; }
        .secret-button .tooltip-text::before { content: 'Revelar'; }
        body.magic-mode-active .secret-button .tooltip-text::before { content: 'Ocultar'; }
        .secret-button:hover .tooltip-text { opacity: 1; visibility: visible; }

        #fireworksCanvas {
            display: none; position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 200; 
            pointer-events: none;
        }
        body.magic-mode-active #fireworksCanvas { display: block; }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0);
            z-index: 199;
            pointer-events: none;
            transition: background-color 0.5s ease;
        }
        body.magic-mode-active::before {
            background-color: rgba(0, 0, 0, 0.6);
        }

        body.magic-mode-active .envelope-container { opacity: 0; transform: scale(0.7); pointer-events: none; }
        /* --- CÓDIGO NOVO ADICIONADO --- */
        body.magic-mode-active .floating-image-container { 
            opacity: 0; 
            transform: translateX(-50%) scale(0.7); 
        }

        body.magic-mode-active .secret-button { opacity: 1; animation: continuous-glow 2s infinite ease-in-out; }
        
        /* --- ANIMAÇÕES ADICIONADAS --- */
        @keyframes breathe {
            from {
                transform: scale(1) translateY(0);
            }
            to {
                transform: scale(1.1) translateY(-15px);
            }
        }
        @keyframes glow {
            0%, 90% { /* O brilho fica desligado na maior parte do tempo */
                filter: drop-shadow(0 0 5px rgba(255, 223, 0, 0));
            }
            92% { /* Acende rapidamente */
                filter: drop-shadow(0 0 25px rgba(255, 223, 0, 1)) drop-shadow(0 0 10px rgba(255, 223, 0, 0.8));
            }
            94%, 100% { /* E apaga */
                filter: drop-shadow(0 0 5px rgba(255, 223, 0, 0));
            }
        }
        @keyframes continuous-glow { 0%, 100% { box-shadow: 0 0 15px rgba(137, 207, 240, 0.6); } 50% { box-shadow: 0 0 25px rgba(137, 207, 240, 1); } }
        
        .secret-image-container { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; 
            justify-content: center; align-items: center;
            z-index: 201;
            opacity: 0; visibility: hidden; pointer-events: none;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        .secret-content {
            display: flex; flex-direction: column; align-items: center;
            transform: scale(0.8); transition: transform 0.4s ease;
        }
        .secret-image {
            width: 90%; max-width: 180px; height: auto; object-fit: contain;
            border-radius: 5px; margin-bottom: 15px; 
        }
        .birthday-message {
            background-color: rgba(255, 255, 255, 0.1); color: #fff; 
            padding: 10px 20px; border: 2px solid #fff; border-radius: 15px;
            font-family: var(--font-cursive); font-size: 1.8em; text-align: center;
        }
        body.magic-mode-active .secret-image-container {
            opacity: 1; visibility: visible; pointer-events: auto;
        }
        body.magic-mode-active .secret-content {
            transform: scale(1);
        }
        #musicOverlay {
          position: fixed;
          top: 0; left: 0;
          width: 100%; height: 100%;
          cursor: pointer;
          z-index: 9999;
          background: transparent;
        }
    </style>
</head>
<body>
    <div id="tsparticles"></div>
    <canvas id="fireworksCanvas"></canvas>

    <div id="musicOverlay"></div> 
    <audio id="musicaFundo" src="hogwa.mp3" loop></audio>

    <div class="floating-image-container">
        <img src="seletor.png" alt="Pomo de Ouro Flutuante" class="floating-image">
    </div>

    <div class="envelope-container" id="envelope">
        <div class="letter">
            <h3>Feliz Aniversário, Beatrice!</h3>
            <p>
                Que seu dia seja tão incrível quanto uma vitória em Hogwarts.<br>
                Que você continue sendo essa pessoa cheia de energia e alegria, sempre iluminando quem está por perto como um feitiço <i>Lumos🕯️</i>.
            </p>
        </div>
        <div class="envelope-back"><div></div></div>
        <div class="flap"></div>
        <img src="hogs.png" alt="Carimbo de Hogwarts" class="top-stamp">
        <img src="carimbo.png" alt="Selo de Cera de Hogwarts" class="seal">
    </div>
    
    <a href="#" id="secret-button" class="secret-button" aria-label="Botão Secreto">
        <div class="hallows-icon">
            <span class="triangle"></span><span class="circle"></span><span class="line"></span>
        </div>
        <span class="tooltip-text"></span>
    </a>

    <div id="image-container" class="secret-image-container">
        <div class="secret-content">
            <img class="secret-image" src="cake.gif" alt="Castelo Mágico">
            <p class="birthday-message">Bia, Parabéns!</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tsparticles-slim@2.12.0/tsparticles.slim.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Música de fundo
            const musicOverlay = document.getElementById("musicOverlay");
            const musicaFundo = document.getElementById("musicaFundo");
            musicaFundo.volume = 0.7;

            musicOverlay.addEventListener("click", () => {
                musicaFundo.play().catch(err => console.log("Interação necessária para tocar música.", err));
                musicOverlay.style.display = 'none';
            }, { once: true });

            tsParticles.load("tsparticles", {
                background: { color: { value: "var(--bg-color)" } }, fpsLimit: 60, particles: { number: { value: 100, density: { enable: true, value_area: 800 } }, color: { value: "#ffffff" }, shape: { type: "circle" }, opacity: { value: 0.5, random: true, anim: { enable: true, speed: 1, opacity_min: 0.1, sync: false } }, size: { value: 3, random: true }, move: { enable: true, speed: 0.5, direction: "none", random: true, straight: false, out_mode: "out" } }, interactivity: { detect_on: "canvas", events: { onhover: { enable: true, mode: "bubble" }, onclick: { enable: false }, resize: true }, modes: { bubble: { distance: 100, size: 4, duration: 2, opacity: 0.8 } } }, detectRetina: true
            });
            const envelope = document.getElementById('envelope');
            const secretButton = document.getElementById('secret-button');

            envelope.addEventListener('click', () => {
                envelope.classList.toggle('open');
            });

            const canvas = document.getElementById('fireworksCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            let fireworks = [];
            let particles = [];
            let launchInterval;
            let animationFrameId;

            function getRandomColor() {
                const hue = Math.floor(Math.random() * 360);
                return `hsl(${hue}, 100%, 50%)`;
            }

            class Firework {
                constructor(x, y, targetX, targetY) {
                    this.x = x; this.y = y; this.targetX = targetX; this.targetY = targetY;
                    this.speed = 2.5;
                    this.angle = Math.atan2(targetY - y, targetX - x);
                    this.distanceToTarget = Math.sqrt((targetX - x)**2 + (targetY - y)**2);
                    this.traveled = 0;
                    this.trail = [];
                    this.color = getRandomColor();
                }
                update() {
                    this.traveled += this.speed;
                    const prevX = this.x; const prevY = this.y;
                    this.x += Math.cos(this.angle) * this.speed;
                    this.y += Math.sin(this.angle) * this.speed;
                    this.trail.push({ x: prevX, y: prevY });
                    if (this.trail.length > 5) { this.trail.shift(); }
                    if (this.traveled >= this.distanceToTarget) {
                        createParticles(this.targetX, this.targetY, this.color);
                        return true; 
                    }
                    return false;
                }
                draw() {
                    ctx.beginPath();
                    ctx.moveTo(this.trail[0]?.x || this.x, this.trail[0]?.y || this.y);
                    ctx.lineTo(this.x, this.y);
                    ctx.strokeStyle = this.color;
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }
            }

            class Particle {
                constructor(x, y, color) {
                    this.x = x; this.y = y; this.color = color;
                    this.angle = Math.random() * Math.PI * 2;
                    this.speed = Math.random() * 5 + 1;
                    this.friction = 0.97;
                    this.gravity = 0.05;
                    this.alpha = 1;
                    this.decay = Math.random() * 0.02 + 0.01;
                }
                update() {
                    this.speed *= this.friction;
                    this.y += this.gravity;
                    this.x += Math.cos(this.angle) * this.speed;
                    this.y += Math.sin(this.angle) * this.speed;
                    this.alpha -= this.decay;
                    return this.alpha <= this.decay;
                }
                draw() {
                    ctx.save();
                    ctx.globalAlpha = this.alpha;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 2, 0, Math.PI * 2, false);
                    ctx.fillStyle = this.color;
                    ctx.fill();
                    ctx.restore();
                }
            }

            function createParticles(x, y, color) {
                const particleCount = 100;
                for (let i = 0; i < particleCount; i++) {
                    particles.push(new Particle(x, y, color));
                }
            }

            function animate() {
                animationFrameId = requestAnimationFrame(animate);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                fireworks = fireworks.filter(firework => !firework.update());
                fireworks.forEach(firework => firework.draw());
                particles = particles.filter(particle => !particle.update());
                particles.forEach(particle => particle.draw());
            }

            function launchRandomFirework() {
                const startX = canvas.width / 2;
                const startY = canvas.height;
                const targetX = Math.random() * canvas.width;
                const targetY = Math.random() * canvas.height / 2;
                fireworks.push(new Firework(startX, startY, targetX, targetY));
            }
            
            function startFireworks() {
                if (launchInterval) clearInterval(launchInterval);
                launchInterval = setInterval(launchRandomFirework, 800);
                animate();
            }

            function stopFireworks() {
                clearInterval(launchInterval);
                cancelAnimationFrame(animationFrameId);
                setTimeout(() => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    fireworks = [];
                    particles = [];
                }, 1000);
            }

            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });

            secretButton.addEventListener('click', (event) => {
                event.preventDefault();
                const isMagicModeActive = document.body.classList.contains('magic-mode-active');
                if (isMagicModeActive) {
                    document.body.classList.remove('magic-mode-active');
                    stopFireworks();
                } else {
                    document.body.classList.add('magic-mode-active');
                    startFireworks();
                }
            });
        });
    </script>
</body>

</html>


